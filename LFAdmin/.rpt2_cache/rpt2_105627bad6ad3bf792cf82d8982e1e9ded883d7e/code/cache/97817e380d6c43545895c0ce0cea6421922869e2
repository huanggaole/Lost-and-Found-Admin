{
  "code": "import Item from \"../script/Item\";\r\nimport Customer from \"../prefab/Customer\";\r\nexport default class GameScene extends Laya.Scene {\r\n    createChildren() {\r\n        super.createChildren();\r\n        this.loadScene(\"GameScene.scene\");\r\n    }\r\n    createCustomer() {\r\n        const cust = new Customer(this);\r\n        this.addChild(cust);\r\n    }\r\n    onMouseDown() {\r\n        if (Item.selectedItem != null) {\r\n            this.ifCanmove = true;\r\n            this.lastx = Laya.stage.mouseX;\r\n            this.lasty = Laya.stage.mouseY;\r\n        }\r\n    }\r\n    onMouseUp() {\r\n        this.ifCanmove = false;\r\n        if (Item.selectedItem != null) {\r\n            let rigidbody = Item.selectedItem.getComponent(Laya.RigidBody);\r\n            rigidbody.setVelocity({ x: 0, y: 0 });\r\n        }\r\n        Item.selectedItem = null;\r\n    }\r\n    updateHP(changevalue) {\r\n        this.HPvalue += changevalue;\r\n        this.HP.text = \"HP: \" + this.HPvalue;\r\n        if (this.HPvalue <= 0) {\r\n            alert(\"动作太慢被顾客投诉啦！游戏失败！\\nYou are too slow that many customers have complained, you lose the game!\");\r\n            this.timer.clearAll(this);\r\n            this.destroy();\r\n        }\r\n    }\r\n    updateScore(changevalue) {\r\n        this.Scorevalue += changevalue;\r\n        this.score.value = this.Scorevalue + \"\";\r\n    }\r\n    onAwake() {\r\n        this.loseItems = [\"bag\", \"cup\", \"plug\", \"handbag\", \"coat\", \"luggage\", \"card\", \"umbrella\"];\r\n        this.on(Laya.Event.MOUSE_DOWN, this, this.onMouseDown);\r\n        this.on(Laya.Event.MOUSE_MOVE, this, () => {\r\n            if (this.ifCanmove) {\r\n                if (Item.selectedItem != null) {\r\n                    let dx = Laya.stage.mouseX - this.lastx;\r\n                    let dy = Laya.stage.mouseY - this.lasty;\r\n                    this.lastx = Laya.stage.mouseX;\r\n                    this.lasty = Laya.stage.mouseY;\r\n                    let rigidbody = Item.selectedItem.getComponent(Laya.RigidBody);\r\n                    rigidbody.setVelocity({ x: dx, y: dy });\r\n                }\r\n            }\r\n        });\r\n        this.on(Laya.Event.MOUSE_UP, this, this.onMouseUp);\r\n        this.on(Laya.Event.MOUSE_OUT, this, this.onMouseUp);\r\n        this.HPvalue = 3;\r\n        this.Scorevalue = 0;\r\n        this.updateHP(0);\r\n        this.updateScore(0);\r\n        this.timer.loop(1000, this, () => {\r\n            if (this.loseItems.length == 0 && Customer.CustomerList.length == 0) {\r\n                alert(\"所有的失物都归还给失主了，真好！\\n你本局游戏得分为：\" + this.Scorevalue + \"\\n\" +\r\n                    \"Well Done! All the lost things have found their owner!\\n You got \" + this.Scorevalue + \" score in this game.\");\r\n                this.timer.clearAll(this);\r\n                this.destroy();\r\n            }\r\n            if (this.loseItems.length == 0) {\r\n                return;\r\n            }\r\n            if (Customer.CustomerList.length == 0) {\r\n                this.createCustomer();\r\n            }\r\n            else if (Math.random() < 0.1) {\r\n                this.createCustomer();\r\n            }\r\n        });\r\n    }\r\n}\r\n",
  "references": [
    "/Users/huanggaole/Lost-and-Found-Admin/LFAdmin/src/script/Item.ts",
    "/Users/huanggaole/Lost-and-Found-Admin/LFAdmin/src/prefab/Customer.ts"
  ]
}
